from trigger.trigger import Trigger
from discord import ApplicationContext, VerificationLevel, ContentFilter

class SafetySetupTrigger(Trigger):
    def __init__(self):
        super().__init__("Safety-Setup Vulnerability")
    
    async def check(self, ctx: ApplicationContext, **kwargs):
        await super().check(ctx)

        guild = ctx.guild
        no_verification = guild.verification_level is VerificationLevel.none
        no_explicit_filter = guild.explicit_content_filter is ContentFilter.disabled

        if no_verification and no_explicit_filter:
            return '[❌] Your server is vulnerable by SSV! Possible solution: configure verification level and explicit content filter in Safety Setup.'
        elif no_verification:
            return '[❌] Your server is vulnerable by SSV! Possible solution: configure verification level in Safety Setup.'
        elif no_explicit_filter:
            return '[❌] Your server is vulnerable by SSV! Possible solution: configure explicit content filter in Safety Setup.'
        
        return '[✅] Your server is NOT vulnerable by EvMV!'